A python port of the octave code
